# Release 8.x.x

Version 8.x.x of the Data Space Connector contains a number of new features and improvements. They will be listed below, together with required actions for migration.

## Marketplace Integration

In order to provide a frontend for the marketplace functionality, the BAE Marketplace(https://github.com/FIWARE-TMForum/Business-API-Ecosystem) was integrated into the Data Space Connector. See [Marketplace Integration](../MARKETPLACE_INTEGRATION.md) for more details.

## Keycloak Update to 26.3.2

Keycloak has some fundamental changes in the configuration of Verifiable Credentials Issuance and in its support of the OID4VCI protocol. Increased support is still a major work-item in Keycloak, thus more changes will come soon.


:warning: Required action:

The configuration of the realm needs to be updated to the new format of keyclaok. See [attributes](https://github.com/FIWARE-TMForum/Business-API-Ecosystem), [client-scopes](https://github.com/FIWARE/data-space-connector/blob/main/k3s/consumer.yaml#L352) and [clients](https://github.com/FIWARE/data-space-connector/blob/main/k3s/consumer.yaml#L667) section of the consumer-example config as an example

## TMForum API update

To better support Marketplace integration and contract negotiation, the TMForum API was updated to 1.3.6. 

If the TMForum API was not used before, nothing has to be done.

:warning: Required action:
If the connector instance already contains data from TMForum <1.0.0, a data migration needs to be executed: https://github.com/FIWARE/tmforum-api/tree/main/data-migrator

## Local Deployment

In order to better support demo-scenarios integrating end-users and frontends, the local deployment now contains an additional proxy to provide access to the services. See https://github.com/FIWARE/data-space-connector/blob/main/doc/deployment-integration/local-deployment/LOCAL.MD#local-deployment and https://github.com/FIWARE/data-space-connector/blob/main/doc/MARKETPLACE_INTEGRATION.md#demo-usage for more details.

## ODRL-PAP

The ODRL-PAP was updated to 1.0.2, in order to better support the accessibility of policies(e.g. query-by-id - see [ODRL-PAP API](https://github.com/wistefan/odrl-pap/blob/main/api/odrl.yaml)). It also requires policies to contain a "odrl:uid" now, to be compliant with the odrl-spec.

:warning: Required actions:

Update all policies to include a "odrl:uid"(see [spec](https://www.w3.org/TR/odrl-model/#policy))

## Verifier & Credentials-Config-Service update for EUDI-Wallet compatibility

In order to be compliant with the current EUDI-Wallet(https://github.com/eu-digital-identity-wallet), the Verifier has various updates in its OID4VP support:

	* presentationDefinition: following the OID4VP spec, the specification of "presentationDefinition" is now supported. See [registration in the provider.yaml](https://github.com/FIWARE/data-space-connector/blob/main/k3s/provider.yaml#L148-L189) as an example
	* jwtInclusion: in order to reduce the size of created JWT-Tokens and flexibility in their structure, the inclusion of VC Claims into the JWT can now be configured. See [Credential-Config-Service API](https://github.com/FIWARE/credentials-config-service/blob/main/api/credentials-config-service.yaml#L225-L253)
	* requestMode: To improve integration with applications and OID4VP compliance, the verifier now supports(in addition to "urlEncoded") the request modes "byValue" and "byReference". See [VCVerifier](https://github.com/FIWARE/VCVerifier?tab=readme-ov-file#request-modes) for more details.  
	* request signing: The verifier now supports signing request objects sent to the wallet. See [Verifier Configuration](https://github.com/FIWARE/VCVerifier?tab=readme-ov-file#configuration) - "verifier.clientIdentification"
	* horizontal scaling: in order to support horizontal scaling, the a Key for signing the JWT's can be provided to the instances. See [Verifier Configuration](https://github.com/FIWARE/VCVerifier?tab=readme-ov-file#configuration) - "verifier.keyAlgorithm", "verifier.generateKey" and "verifier.keyPath"
    
Required actions:
	* update Verifier configuration - see [provider.yaml - vcverifier](https://github.com/FIWARE/data-space-connector/blob/main/k3s/provider.yaml#L239-L247) as example
	* update Credentials-Configuration - see [provider.yaml - credentials-config-service](https://github.com/FIWARE/data-space-connector/blob/main/k3s/provider.yaml#L148-L225) as example

## Wallet Integration

For various Use-Cases, the integration of EUDI Wallet - compatible End-User Wallets is required. The new version of the Data Space Connector contains a local runnable example, demonstrating the integration with the current [Reference Implementation](https://github.com/eu-digital-identity-wallet/eudi-app-android-wallet-ui). See [Marketplace integration - The Wallet](https://github.com/FIWARE/data-space-connector/blob/main/doc/MARKETPLACE_INTEGRATION.md) for more. 