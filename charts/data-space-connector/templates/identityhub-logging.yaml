#################################################################################
  #  Copyright (c) 2025 Cofinity-X
  #  Copyright (c) 2025 LKS Next
  #  Copyright (c) 2025 Contributors to the Eclipse Foundation
  #
  #  See the NOTICE file(s) distributed with this work for additional
  #  information regarding copyright ownership.
  #
  #  This program and the accompanying materials are made available under the
  #  terms of the Apache License, Version 2.0 which is available at
  #  https://www.apache.org/licenses/LICENSE-2.0.
  #
  #  Unless required by applicable law or agreed to in writing, software
  #  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
  #  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
  #  License for the specific language governing permissions and limitations
  #  under the License.
  #
  #  SPDX-License-Identifier: Apache-2.0
  #################################################################################


---
{{- if (eq .Values.identityhub.enabled true) }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: identityhub-logging
  namespace: {{ .Release.Namespace | default "default" | quote }}
  labels:
    app.kubernetes.io/name: identityhub
    app.kubernetes.io/instance: {{ .Release.Name }}
data:
  logging.properties: |-
  {{- if .Values.identityhub.logging.enabled }}
    handlers={{- join "," .Values.identityhub.logging.handlers }}
    {{- $console := "java.util.logging.ConsoleHandler" }}
    {{- $file := "java.util.logging.FileHandler" }}
    {{- if has $console .Values.identityhub.logging.handlers }}
    # Console Handler Config
    {{- range $key, $value := index .Values.identityhub.logging.handlersConfig $console }}
    {{ $console }}.{{ $key }} = {{ $value }}
    {{- end }}
    {{- end }}
    {{- if has $file .Values.identityhub.logging.handlers }}
    # File Handler Config
    {{- range $key, $value := index .Values.identityhub.logging.handlersConfig $file }}
    {{ $file }}.{{ $key }} = {{ $value }}
    {{- end }}
    {{- end }}
    # Formatter Configs
    {{- range $formatter, $config := .Values.identityhub.logging.formatters }}
    {{ $formatter }}.format = {{ $config.format }}
    {{- end }}
    # Root level and Package level control
    .level={{- .Values.identityhub.logging.level }}
    {{- range $pkg, $level := .Values.identityhub.logging.logLevels }}
    {{ $pkg }}.level = {{ $level }}
    {{- end }}
  {{- else }}
    {{ .Values.identityhub.logging.default | indent 4 }}
  {{- end }}
{{- end }}