# -- configuration to be shared between the authentication components
authentication:
  generatePasswords:
    # -- should a password for the database connection of authentication components be generated in the cluster
    enabled: true
    #-- name of the secret to put the generated password into
    secretName: authentication-database-secret

# -- configuration to be shared between the dataplane components
dataplane:
  generatePasswords:
    # -- should a password for the database connection of dataplane components be generated in the cluster
    enabled: true
    #-- name of the secret to put the generated password into
    secretName: data-service-secret

# -- configuration to be shared between the issuance components
issuance:
  generatePasswords:
    # -- should a password for the database connection of issuance components be generated in the cluster
    enabled: true
    #-- name of the secret to put the generated password into
    secretName: issuance-secret

# -- configuration for the mysql to be deployed as part of the connector, see https://github.com/bitnami/charts/tree/main/bitnami/mysql for all options
mysql:
  kubeVersion: 1.34-1
  # -- should it be enabled? set to false if one outside the chart is used.
  enabled: true
  global:
    security:
      # allow the image from the legacy repo
      allowInsecureImages: true
  # -- configuration of the used image
  image:
    # -- repository where the image is held, see https://github.com/bitnami/charts/issues/35164 for further info
    repository: bitnamilegacy/mysql
  # -- allows to set a fixed name for the services
  fullnameOverride: authentication-mysql
  # -- configure authentication to mysql
  auth:
    # -- name of the secret to take the passowrds from
    existingSecret: authentication-database-secret
  # -- scripts to be executed on db startup
  initdbScripts:
    create.sql: |
      CREATE DATABASE tildb;
      CREATE DATABASE ccsdb;

# -- configuration for the trusted-issuers-list to be deployed as part of the connector, see https://github.com/FIWARE/helm-charts/tree/main/charts/trusted-issuers-list for all options
trusted-issuers-list:
  # -- should it be enabled? set to false if one outside the chart is used.
  enabled: true
  # -- allows to set a fixed name for the services
  fullnameOverride: trusted-issuers-list
  # -- connection to the database
  database:
    # -- should persistence be used?
    persistence: true
    # -- name of the db user
    username: root
    # -- configuration for the existing secret to get the passwords from
    existingSecret:
      enabled: true
      name: authentication-database-secret
      key: mysql-root-password
    # -- host of the database
    host: authentication-mysql
    # -- name of the schema inside the db
    name: tildb

# -- configuration for the vcverifier to be deployed as part of the connector, see https://github.com/FIWARE/helm-charts/tree/main/charts/vcverifier for all options
vcverifier:
  # -- should it be enabled? set to false if one outside the chart is used.
  enabled: true
  # -- allows to set a fixed name for the services
  fullnameOverride: verifier
  # -- configuration for the m2m flow, in case the tir is requiring authentication
  m2m:
    # -- we do not need authentication here
    authEnabled: false

# -- configuration for the digital-signature.service to be deployed as part of the connector in case of did:elsi support
dss:
  # -- should it be enabled?
  enabled: false
  # -- allows to set a fixed name for the services
  fullnameOverride: dss
  # -- can be used to provide the crl for ca's provided as truststore to the dss
  crl:
    # -- should it be enabled?
    enabled: false


# -- configuration for the credentials-config-service to be deployed as part of the connector, see https://github.com/FIWARE/helm-charts/tree/main/charts/credentials-config-service for all options
credentials-config-service:
  # -- should it be enabled? set to false if one outside the chart is used.
  enabled: true
  # -- allows to set a fixed name for the services
  fullnameOverride: credentials-config-service
  # -- connection to the database
  database:
    # -- should persistence be used?
    persistence: true
    # -- name of the db user
    username: root
    # -- configuration for the existing secret to get the passwords from
    existingSecret:
      enabled: true
      name: authentication-database-secret
      key: mysql-root-password
    # -- host of the database
    host: authentication-mysql
    # -- name of the schema inside the db
    name: ccsdb
  registration:
    enabled: false
# -- configuration for the postgresql to be deployed as part of the connector, see https://github.com/bitnami/charts/tree/main/bitnami/postgresql for all options
postgresql:
  kubeVersion: 1.34-1
  # -- should it be enabled? set to false if one outside the chart is used.
  enabled: true
  global:
    security:
      # allow the image from the legacy repo
      allowInsecureImages: true
  # -- configuration of the used image
  image:
    # -- repository where the image is held, see https://github.com/bitnami/charts/issues/35164 for further info
    repository: bitnamilegacy/postgresql
    # -- fixes the unpullable image referenced in the chart
    tag: 13.18.0
  # -- allows to set a fixed name for the services
  fullnameOverride: postgresql
  generatePasswords:
    # -- should a password for the database be generated in the cluster
    enabled: true
    # -- name of the secret to store the password in
    secretName: database-secret
  # -- configure authentication to mysql
  auth:
    # -- name of the secret to take the passowrds from
    existingSecret: database-secret
    # -- key of the secrets inside the secret
    secretKeys:
      adminPasswordKey: postgres-admin-password
      userPasswordKey: postgres-user-password
  # -- configuration for the primary of the db
  primary:
    # -- scripts to be run on intialization
    initdb:
      scripts:
        create.sh: |
          psql postgresql://postgres:${POSTGRES_PASSWORD}@localhost:5432 -c "CREATE DATABASE pap;"
          psql postgresql://postgres:${POSTGRES_PASSWORD}@localhost:5432 -c "CREATE DATABASE keycloak;"
          psql postgresql://postgres:${POSTGRES_PASSWORD}@localhost:5432 -c "CREATE DATABASE rainbow;"
          psql postgresql://postgres:${POSTGRES_PASSWORD}@localhost:5432 -c "CREATE DATABASE ih;"
          psql postgresql://postgres:${POSTGRES_PASSWORD}@localhost:5432 -c "CREATE DATABASE issuer;"

# -- configuration for the odrl-pap to be deployed as part of the connector, see https://github.com/FIWARE/helm-charts/tree/main/charts/odrl-pap for all options
odrl-pap:
  # -- should it be enabled? set to false if one outside the chart is used.
  enabled: true
  # -- allows to set a fixed name for the services
  fullnameOverride: odrl-pap
  # -- connection to the database
  database:
    # -- url to connect the db at
    url: jdbc:postgresql://postgresql:5432/pap
    # -- username to access the db
    username: postgres
    # -- secret to take the password from
    existingSecret:
      enabled: true
      name: database-secret
      key: postgres-admin-password

# -- configuration for the open-policy-agent to be deployed as part of the connector fulfilling the role of the PDP, as a sidecar to apisix
opa:
  # -- should an opa sidecar be deployed to apisix
  enabled: true
  # -- address of the pap to get the policies from
  resourceUrl: http://odrl-pap:8080/bundles/service/v1
  # -- port to make opa available at
  port: 8181
  # -- pull delays for the policies bundle
  policies:
    minDelay: 2
    maxDelay: 4
  # -- pull delays for the methods bundle
  methods:
    minDelay: 1
    maxDelay: 3
  # -- pull delays for the data bundle
  data:
    minDelay: 1
    maxDelay: 15


# -- integration of checks for the transfer process protocol
tpp:
  # -- should checking for a running transfer process be enabled
  enabled: false
  transfers:
    # -- host of the endpoint to check the process id, e.g. rainbow
    host: ""
    # -- path to check the id at
    path: /transfers
  
# -- configuration for apisix to be deployed as part of the connector, see https://github.com/bitnami/charts/tree/main/bitnami/apisix for all options
apisix:
  kubeVersion: 1.34-1
  global:
    security:
      # allow the image from the legacy repo
      allowInsecureImages: true
  # -- configuration of the used image
  image:
    # -- repository where the image is held, see https://github.com/bitnami/charts/issues/35164 for further info
    repository: bitnamilegacy/apisix
    debug: true
  waitContainer:
    # -- configuration of the used image
    image:
      # -- repository where the image is held, see https://github.com/bitnami/charts/issues/35164 for further info
      repository: bitnamilegacy/os-shell
  # -- should it be enabled? set to false if one outside the chart is used.
  enabled: true
  # -- configuration in regard to the apisix control plane
  controlPlane:
    # -- should it be enabled
    enabled: true
    # -- resource preset to have sufficient memory
    resourcesPreset: small
    # -- override the name to have a stable service address
    fullnameOverride: apisix-controlplane
    # -- provide a token for accessing the controlplane
    apiTokenAdmin: admin
    # -- disable tls for internal controlplane access
    tls:
      enabled: false
  # -- configuration in regard to the apisix ingressController
  ingressController:
    # -- should it be enabled
    enabled: false
    # -- configuration of the used image
    image:
      # -- repository where the image is held, see https://github.com/bitnami/charts/issues/35164 for further info
      repository: bitnamilegacy/apisix-ingress-controller
  # -- configuration in regard to the apisix etcd
  etcd:
    kubeVersion: 1.34-1
    # -- should it be enabled
    enabled: true
    global:
      security:
        # allow the image from the legacy repo
        allowInsecureImages: true
    # -- configuration of the used image
    image:
      # -- repository where the image is held, see https://github.com/bitnami/charts/issues/35164 for further info
      repository: bitnamilegacy/etcd
    # -- persistence configuration of etcd
    persistence:
      # -- should it be enabled
      enabled: false
  # -- configuration in regard to the apisix dataplane
  dataPlane:
    # -- resource preset to have sufficient memory
    resourcesPreset: small
    # -- configuration for extra configmaps to be deployed
    extraConfig:
      deployment:
        # -- allows to configure apisix through a yaml file
        role_data_plane:
          config_provider: etcd
      apisix:
        extra_lua_path: /extra/apisix/plugins/?.lua
    # -- extra volumes
    # we need `routes` to declaratively configure the routes
    # and the config for the opa sidecar
    extraVolumes:
      - name: routes
        configMap:
          name: apisix-routes
      - name: opa-config
        configMap:
          name: opa-config
      - name: opa-lua
        configMap:
          name: opa-lua
      - name: tpp-policy
        configMap:
          name: tpp-policy
    # -- extra volumes to be mounted
    extraVolumeMounts:
      - name: routes
        mountPath: /usr/local/apisix/conf/apisix.yaml
        subPath: apisix.yaml
      - name: opa-lua
        mountPath: /usr/local/apisix/apisix/plugins/opa/helper.lua
        subPath: helper.lua
      - name: opa-lua
        mountPath: /usr/local/apisix/apisix/plugins/opa.lua
        subPath: opa.lua
    # -- sidecars to be deployed for apisix
    sidecars:
      # -- we want to deploy the open-policy-agent as a pdp
      - name: open-policy-agent
        image: openpolicyagent/opa:1.2.0
        imagePullPolicy: IfNotPresent
        ports:
          - name: http
            containerPort: 8181
            protocol: TCP
        # opa should be started to listen at 8181 and get its config from the mounted config yaml
        args:
          - "run"
          - "--ignore=.*"  # exclude hidden dirs created by Kubernetes
          - "--server"
          - "-l"
          - "debug"
          - "-c"
          - "/config/opa.yaml"
          - "--addr"
          - "0.0.0.0:8181"
          - "/tpp/tpp.rego"
        volumeMounts:
          - name: opa-config
            mountPath: /config
          - name: tpp-policy
            mountPath: /tpp
  # -- configuration in regard to the apisix dashboard
  dashboard:
    # -- should it be enabled
    enabled: false
    # -- resource preset to have sufficient memory
    resourcesPreset: small
 
  # -- configuration of a catchAll-route(e.g. /*)
  catchAllRoute:
    # -- should it be enabled
    enabled: true
    # -- configuration to connect the upstream broker
    upstream:
      url: http://my-broker:8000
    # -- configuration to verify the jwt, coming from the verifier
    oidc:
      clientId: mySecuredService
      discoveryEndpoint: http://verifier:3000/services/mySecuredService/.well-known/openid-configuration

  # -- configuration of routes for apisix
  routes:
#    - uri: /myRoute
#      upstream:
#        nodes:
#            http://my-upstream-service:8080: 1
#        type: roundrobin
#      plugins:
#        openid-connect:
#          client_id: test-id
#          client_secret: the-secret
#          bearer_only: true
#          use_jwks: true
#          discovery: http://the-service/.well-known/openid-configuration
#        opa:
#          host: "http://localhost:8181"
#          policy: policy/main/allow

# -- configuration for the postgresql to be deployed as part of the connector, see https://github.com/bitnami/charts/tree/main/bitnami/postgresql for all options
postgis:
  kubeVersion: 1.34-1
  # -- should it be enabled? set to false if one outside the chart is used.
  enabled: true
  global:
    security:
      # allow the image from the legacy repo
      allowInsecureImages: true
  image:
    # -- fixes the unpullable image referenced in the chart
    tag: 13.18.0
    # -- repository where the image is held, see https://github.com/bitnami/charts/issues/35164 for further info
    repository: bitnamilegacy/postgresql
  # -- overrides the generated name, provides stable service names - this should be avoided if multiple instances are available in the same namespace
  fullnameOverride: data-service-postgis
  # -- overrides the generated name, provides stable service names - this should be avoided if multiple instances are available in the same namespace
  nameOverride: data-service-postgis
  ## auth configuration for the database
  auth:
    existingSecret: data-service-secret
    secretKeys:
      adminPasswordKey: postgres-admin-password
      userPasswordKey: postgres-user-password
  ## configuration of the postgres primary replicas
  primary:
    ## provide db initialization
    initdb:
      ## provide scripts for initialization
      scripts:
        # -- enable the postgis extension and create the database as expected by scorpio
        enable.sh: |
          psql postgresql://postgres:${POSTGRES_PASSWORD}@localhost:5432 -c "CREATE EXTENSION postgis;"
          psql postgresql://postgres:${POSTGRES_PASSWORD}@localhost:5432 -c "CREATE DATABASE ngb;"

## configuration of the context-broker - see https://github.com/FIWARE/helm-charts/tree/main/charts/scorpio-broker-aaio for details
scorpio:
  fullnameOverride: data-service-scorpio
  # -- should scorpio be enabled
  enabled: true
  ## configuration of the image to be used
  image:
    # -- repository to be used - resource friendly all-in-one-runner without kafka
    repository: scorpiobroker/all-in-one-runner
    # -- tag of the image to be used - latest java image without kafka
    tag: java-4.1.10
  ## configuration of the database to be used by broker
  db:
    # -- host of the db
    dbhost: data-service-postgis
    # -- username to be used
    user: postgres
    existingSecret:
      enabled: true
      name: data-service-secret
      key: postgres-admin-password
  ## configuration of the readiness probe
  readinessProbe:
    # -- path to be used for the readiness probe, older versions used /actuator/health
    path: /q/health
  ## configuration of the liveness probe
  livenessProbe:
    # -- path to be used for the readiness probe, older versions used /actuator/health
    path: /q/health
  ## configuration to be used for the service offered by scorpio
  service:
    # -- ClusterIP is the recommended type for most clusters
    type: ClusterIP
  # -- configuration to register the dataplane at the credentials-config-service
  ccs:
    # -- should the automatic registration of scorpio be enabled
    enabled: false
    # -- endpoint of the ccs to regsiter at
    endpoint: http://credentials-config-service:8080
    # -- configmap to get the registration information from
    configMap: scorpio-registration

  # -- additional init containers to be used for the dataplane
  #initContainers:
    # -- curl container to register at the credentials config service
    #- name: register-credential-config
    #  image: quay.io/curl/curl:8.1.2
    #  command: [ "/bin/sh", "-c", "/bin/init.sh" ]
    #  volumeMounts:
    #    - name: scorpio-registration
    #      mountPath: /bin/init.sh
    #      subPath: init.sh
  # -- additonal volumes to be mounted for the dataplane
  additionalVolumes:
    - name: scorpio-registration
      configMap:
        name: scorpio-registration
        defaultMode: 0755

# -- configuration to issue credentials, using a did:elsi
elsi:
  # -- should a did:elsi be used
  enabled: false
  # -- keystore to be used for signing the credentials 
  # keystore: 
    # store.p12: <THE_ENCODED_CONTENT>
  # -- the did to be used
  did:
  # -- algorithm of the signing key
  keyAlgorithm:
  # -- path to the keystore 
  storePath:
  # -- password for the keystore
  storePassword:
  # -- alias of the key
  keyAlias: 
  # -- password of the key
  keyPassword:

## configuration of the keycloak - see https://github.com/bitnami/charts/tree/main/bitnami/keycloak for details
keycloak:
  kubeVersion: 1.34-1
  # -- should it be enabled? set to false if one outside the chart is used.
  enabled: true
  global:
    security:
      # allow the image from the legacy repo
      allowInsecureImages: true
  # -- configuration of the used image
  image:
    # -- repository where the image is held, see https://github.com/bitnami/charts/issues/35164 for further info
    repository: bitnamilegacy/keycloak
  # -- disable the security context, required by the current quarkus container, will be solved in the future chart versions of keycloak
  containerSecurityContext:
    enabled: false
  proxyHeaders: xforwarded
  proxy: edge
  tls:
    enabled: false
  service:
    ports:
      http: 8080
    extraPorts: 
      - name: management
        port: 9000
        targetPort: 9000
  # -- authentication config for keycloak
  auth:
    existingSecret: issuance-secret
    passwordSecretKey: keycloak-admin
    adminUser: keycloak-admin

  # -- sets memory requests for keycloak
  # increased above the bitnami defaults to prevent OOMs in linux kernel >=6.14
  resources:
    requests:
      memory: "500Mi"
      cpu: "0.5"
    limits:
      memory: "2Gi"
      cpu: "1"

  # -- increase thresholds to prevent crashloops in low resource deployments
  livenessProbe: 
    failureThreshold: 20
  readinessProbe:
    failureThreshold: 20

  # -- should the db be deployed as part of the keycloak chart
  postgresql:
    enabled: false
  # -- host of the external db to be used
  externalDatabase:
    host: postgresql
    database: keycloak
    user: postgres
    existingSecret: database-secret
    existingSecretPasswordKey: postgres-admin-password

  # -- extra volumes to be mounted
  extraVolumeMounts:
    - name: realms
      mountPath: /opt/bitnami/keycloak/data/import

  # -- extra env vars to be set. we require them at the moment, since some of the chart config mechanisms only work with the bitnami-image
  extraEnvVars:
    - name: KEYCLOAK_EXTRA_ARGS
      value: "--import-realm --health-enabled true"
    - name: KC_FEATURES
      value: "oid4vc-vci"
    # password for reading the key store connected to the did
    - name: STORE_PASS
      valueFrom:
        secretKeyRef:
          name: issuance-secret
          key: store-pass
    # keycloak admin password
    - name: KC_ADMIN_PASSWORD
      valueFrom:
        secretKeyRef:
          name: issuance-secret
          key: keycloak-admin
    # set in accordance with the memory requests, will result in OOM otherwise
    - name: KC_HEAP_SIZE
      value: "1024m"
    - name: KC_HEALTH_ENABLED
      value: "true"

  # -- configuration of the realm to be imported
  realm:
    # -- should the realm be imported
    import: true
    # -- name of the realm
    name: test-realm
    # -- frontend url to be used for the realm
    frontendURL: http://localhost:8080
    # -- client roles to be imported - be aware the env vars can be used and will be replaced
    clientRoles: |
      "${DID}": [
        {
          "name": "ADMIN",
          "description": "Is allowed to do everything",
          "clientRole": true
        }
      ]
    # -- users to be imported - be aware the env vars can be used and will be replaced
    users: |
      {
        "username": "admin-user",
        "enabled": true,
        "email": "admin@provider.org",
        "firstName": "Test",
        "lastName": "Admin",
        "credentials": [
          {
            "type": "password",
            "value": "test"
          }
        ],
        "clientRoles": {
          "${DID}": [
            "ADMIN"
          ],
          "account": [
            "view-profile",
            "manage-account"
          ]
        },
        "groups": [
        ]
      }
    # -- clients to be imported - be aware the env vars can be used and will be replaced
    clients: |
      {
        "clientId": "${DID}",
        "enabled": true,
        "description": "Client to manage itself",
        "surrogateAuthRequired": false,
        "alwaysDisplayInConsole": false,
        "clientAuthenticatorType": "client-secret",
        "defaultRoles": [],
        "redirectUris": [],
        "webOrigins": [],
        "notBefore": 0,
        "bearerOnly": false,
        "consentRequired": false,
        "standardFlowEnabled": true,
        "implicitFlowEnabled": false,
        "directAccessGrantsEnabled": false,
        "serviceAccountsEnabled": false,
        "publicClient": false,
        "frontchannelLogout": false,
        "protocol": "oid4vc",
        "attributes": {
          "oid4vci.enabled": true,
          "client.secret.creation.time": "1675260539",
          "vc.natural-person.format": "jwt_vc",
          "vc.natural-person.scope": "NaturalPersonCredential",
          "vc.verifiable-credential.format": "jwt_vc",
          "vc.verifiable-credential.scope": "VerifiableCredential"
        },
        "protocolMappers": [
          {
            "name": "target-role-mapper",
            "protocol": "oid4vc",
            "protocolMapper": "oid4vc-target-role-mapper",
            "config": {
              "subjectProperty": "roles",
              "clientId": "${DID}",
              "supportedCredentialTypes": "NaturalPersonCredential"
            }
          },
          {
            "name": "target-vc-role-mapper",
            "protocol": "oid4vc",
            "protocolMapper": "oid4vc-target-role-mapper",
            "config": {
              "subjectProperty": "roles",
              "clientId": "${DID}",
              "supportedCredentialTypes": "VerifiableCredential"
            }
          },
          {
            "name": "context-mapper",
            "protocol": "oid4vc",
            "protocolMapper": "oid4vc-context-mapper",
            "config": {
              "context": "https://www.w3.org/2018/credentials/v1",
              "supportedCredentialTypes": "VerifiableCredential,NaturalPersonCredential"
            }
          },
          {
            "name": "email-mapper",
            "protocol": "oid4vc",
            "protocolMapper": "oid4vc-user-attribute-mapper",
            "config": {
              "subjectProperty": "email",
              "userAttribute": "email",
              "supportedCredentialTypes": "NaturalPersonCredential"
            }
          }
        ],
        "authenticationFlowBindingOverrides": {},
        "fullScopeAllowed": true,
        "nodeReRegistrationTimeout": -1,
        "defaultClientScopes": [],
        "optionalClientScopes": []
      }
  # -- configuration for the signing key to be used for issuing credentials
  # signingKey:
    # -- path to the keystore containing the signing key
    # storePath:
    # -- password for the keystore containing the signing key
    # storePassword:
    # -- alias of the signing key
    # keyAlias:
    # -- password of the signing key
    # keyPassword:
    # -- algorithm of the signing key
    # keyAlgorithm: 
    # -- did that the key belongs to 
    # did: 

## configuration of the tm-forum-api - see https://github.com/FIWARE/helm-charts/tree/main/charts/tm-forum-api for details
tm-forum-api:
  # -- should it be enabled? set to false if one outside the chart is used.
  enabled: true
  ## configuration to be used by every api-deployment if nothing specific is provided.
  defaultConfig:
    image: 
      tag: 1.4.2-PRE-124
    # --  ngsi-ld broker connection information
    ngsiLd:
      # -- address of the broker
      url: http://data-service-scorpio:9090
    contextUrl: https://raw.githubusercontent.com/wistefan/edc-dsc/refs/heads/init/odrl-context.jsonld
    additionalEnvVars: 
      - name: API_EXTENSION_ENABLED
        value: "true"
      - name: GENERAL_NGSILDORQUERYVALUE
        value: ","
      - name: GENERAL_NGSILDORQUERYKEY
        value: ","
      - name: GENERAL_ENCLOSEQUERY
        value: "false"
  # enable the api proxy
  apiProxy:
    enabled: true
    image:
      tag: distroless-v1.27-latest
    service:
      # -- name to be used for the proxy service.
      nameOverride: tm-forum-api


  # -- list of apis to be deployed
  # -- every api needs to define a name and image. Basepath is required when routes or ingress will be enabled. Beside that, they can overwrite the default-config by using the same keys.
  # -- be aware: when you change the image repositrory or the tag for an api, you have to provide both values for the changes to take effect
  apis:
    - name: party-catalog
      image: tmforum-party-catalog
      basePath: /tmf-api/party/v4

    - name: customer-bill-management
      image: tmforum-customer-bill-management
      basePath: /tmf-api/customerBillManagement/v4

    - name: customer-management
      image: tmforum-customer-management
      basePath: /tmf-api/customerManagement/v4

    - name: product-catalog
      image: tmforum-product-catalog
      basePath: /tmf-api/productCatalogManagement/v4

    - name: product-inventory
      image: tmforum-product-inventory
      basePath: /tmf-api/productInventory/v4

    - name: product-ordering-management
      image: tmforum-product-ordering-management
      basePath: /tmf-api/productOrderingManagement/v4

    - name: resource-catalog
      image: tmforum-resource-catalog
      basePath: /tmf-api/resourceCatalog/v4

    - name: resource-function-activation
      image: tmforum-resource-function-activation
      basePath: /tmf-api/resourceFunctionActivation/v4

    - name: resource-inventory
      image: tmforum-resource-inventory
      basePath: /tmf-api/resourceInventoryManagement/v4

    - name: service-catalog
      image: tmforum-service-catalog
      basePath: /tmf-api/serviceCatalogManagement/v4

    - name: agreement
      image: tmforum-agreement
      basePath: /tmf-api/agreementManagement/v4

    - name: usage-management
      image: tmforum-usage-management
      basePath: /tmf-api/usageManagement/v4

    - name: quote
      image: tmforum-quote
      basePath: /tmf-api/quote/v4

    - name: account
      image: tmforum-account
      basePath: /tmf-api/accountManagement/v4
      
  # redis caching
  redis:
    enabled: false

  registration:
    enabled: true
    # -- name to be used for the registration jobs
    name: tmf-api-registration
    # -- configuration to register the dataplane at the credentials-config-service
    ccs:
      # -- endpoint of the ccs to regsiter at
      endpoint: http://credentials-config-service:8080
      # -- service id of the data-service to be used
      id: tmf-api
      # -- default scope to be created for the data plane
      defaultOidcScope:
        # -- name of the scope
        name: default
        # -- name of the default credential to be configured
        credentialType: VerifiableCredential
        # -- needs to be updated for the concrete dataspace
        trustedParticipantsLists: http://tir.trust-anchor.org
        trustedIssuersLists: http://trusted-issuers-list:8080


## configuration of rainbow to provide integration with the Dataspace Protocol
rainbow:
  # -- should rainbow be enabled
  enabled: false
  # -- database configuration of rainbow
  db:
    # -- host of the database to be used
    url:
    # -- user to be used when accesing the database
    user: 
    # -- secret containing the password for the database
    existingSecret:
    # -- key of the password inside that secret
    passwordKey:
  # -- configuration for external access to rainbow
  ingress:
    # -- should the ingress be enabled
    enabled: false
    # -- annotations to be added to the ingress
    annotations: {}
      # kubernetes.io/ingress.class: "ambassador"
      ## example annotations, allowing cert-manager to automatically create tls-certs and forcing everything to use ssl.
      # kubernetes.io/tls-acme: "true"
      # ingress.kubernetes.io/ssl-redirect: "true"
    # -- all hosts to be provided
    hosts: []
      ## provide a hosts and the paths that should be available
      # - host: localhost
        # paths:
        # - /
    # -- configure the ingress' tls
    tls: []
      # - secretName: rainbow-tls
        # hosts:
          # - rainbow.fiware.org
  # -- configuration of service access to rainbow
  service:
    # -- service type to be used
    serviceType: ClusterIP
    # -- port of the service
    port: 8080
  # -- configuration to register rainbow at the credentials-config-service
  ccs:
    # -- should the registration at the credentials-config-service be enabled
    enabled: false
    # -- endpoint of the ccs to regsiter at
    endpoint: http://credentials-config-service:8080
    # -- configmap to get the registration information from
    configMap: rainbow-registration
    # -- service id of the data-service to be used
    id: tpp-service

## configuration of the tm-forum-api - see https://github.com/FIWARE/helm-charts/tree/main/charts/contract-management for details
contract-management:
  # -- should it be enabled? set to false if one outside the chart is used.
  enabled: true
  fullnameOverride: contract-management
  til:
    credentialType: OperatorCredential
  services:
    ## Config for Trusted Issuers List
    trusted-issuers-list:
      ## URL of the Trusted Issuers List Service
      url: http://trusted-issuers-list:8080
    ## Config for the TM Forum Service hosting the APIs
    product-order:
      ## URL of the TM Forum Service hosting the Product Ordering API
      url: http://tm-forum-api:8080
    party:
      ## URL of the TM Forum Service hosting the Party API
      url: http://tm-forum-api:8080
    product-catalog:
      ## URL of the TM Forum Service hosting the Product Catalog API
      url: http://tm-forum-api:8080
    service-catalog:
      ## URL of the TM Forum Service hosting the Service Catalog API
      url: http://tm-forum-api:8080
    tmforum-agreement-api:
      ## URL of the TM Forum Service hosting the Agreement API
      url: http://tm-forum-api:8080
    quote:
      ## URL of the TM Forum Service hosting the Quote API
      url: http://tm-forum-api:8080
    rainbow:
      ## URL for the Rainbow service
      url: http://rainbow:8080
    odrl:
      ## URL to the ODRL-PAP
      url: http://odrl-pap:8080
  

# -- configuration for the did-helper, should only be used for demonstrational deployments, see https://github.com/wistefan/did-helper
did:
  enabled: false

# -- configuration for registering a participant at the til, will most probably only be used in demonstrational enviornments
registration:
  enabled: false

# -- configuration for the .well-known/data-space-configuration endpoint document
dataSpaceConfig:
  enabled: false

  # -- Kubernetes Service type
  serviceType: ClusterIP

  # -- Kubernetes Service port
  port: 3002

  # -- Supported data models by the service (array of links to JSON schemas)
  supportedModels: []

  # -- Supported protocols (e.g.: http,https)
  supportedProtocols: []

  # -- Supported authentication protocols (e.g.: oid4vp)
  authenticationProtocols: []


## didJson provider to make the did.json file available
didJson:
  # -- should the did.json be provided?
  enabled: false
  # -- port of the service to be used
  port: 3000
  # -- did to be serverd
  did:
  # -- key material to be provided in the jwk of the did.json
  key:
    # -- kty to be used in the jwk - RSA and EC supported
    kty: EC
    # -- optional x5u endpoint to provide access to the corresponding cert chain
    x5u: 
    # -- In case of kty==EC: xCoord of the EC key 
    xCoord:
    # -- In case of kty==EC: yCoord of the EC key 
    yCoord:
    # -- In case of kty==EC: curve to be used for the EC key
    crv:
    # -- In case of kty==RSA: exponent of the RSA key
    exponent:
    # -- In case of kty==RSA: modulus of the RSA key
    modulus:
  # -- ingress configuration of the did.json
  ingress:
    # -- should the ingress be enabled?
    enabled: false
    # -- host to provide the did.json at
    host:
    # -- tls secret to be used for the ingress
    tlsSecret:
    # -- annotations to be applied to the ingress
    annotations:
      traefik.ingress.kubernetes.io/service.passhostheader: "true"
      traefik.ingress.kubernetes.io/router.tls: "true"

## Installation of the mongo-operator - see https://github.com/mongodb/helm-charts/tree/main/charts/community-operator
mongo-operator:
  # -- should the mongo-operator be installed
  enabled: false

## Usage of the mongo-operator - see https://github.com/mongodb/mongodb-kubernetes-operator
managedMongo:
  # -- should it be enabled?
  enabled: false
  # -- spec as defined in https://github.com/mongodb/helm-charts/tree/main/charts/community-operator-crds
  spec:
    additionalMongodConfig:
      storage.wiredTiger.engineConfig.journalCompressor: zlib

# -- configuration for the marketplace components
marketplace:
  enabled: false

  # -- should a password for the database connection of marketplace components be generated in the cluster
  generatePasswords: true

  # -- should the tmforum deployed together with the marketplace?
  bizEcosystemApis:
    enabled: false
  # -- should RSS be enabled?
  bizEcosystemRss:
    enabled: false
  # -- should vc based auth enabled?
  siop:
    enabled: true
    # -- should the market place automatically registered in the credentials config service?
    ccs:
      enabled: false
    # -- paths to the verifier
    verifier:
      qrCodePath: /api/v2/loginQR
      tokenPath: /token
      jwksPath: /.well-known/jwks
    # -- roles allowed by the market
    allowedRoles:
      - seller
      - customer
      - admin
  
  # -- configuration for the charging backend
  bizEcosystemChargingBackend:
        
    existingSecret: mongodb-charging-password

    # -- max size to be used for the market
    maxUploadSize: "5242880"

    serviceAccount:
      create: false

    # -- configuration of the charging backend to be deployed
    deployment:
      image:
        tag: 10.5.0
    
    # -- should plugin support be enabled
    plugins:
      enabled: false

    media:
      enabled: false
    
    port: 8006

    loglevel: debug

    payment:
      method: None


    backup:
      enabled: false

    initContainers: false
    propagateToken: true
    basePath: /opt/business-ecosystem-charging-backend
    token: 
      enabled: false

    db:
      host: mongodb-svc
      database: charging_db
      user: charging
      secretKey: password

  oauth:
    provider: "vc"

  # -- configuration for the logic proxy
  bizEcosystemLogicProxy:

    serviceAccount:
      create: true
    
    existingSecret: mongodb-belp-password

    # -- image to be used for the statefulset
    statefulset:
      image:
        repository: fiware/biz-ecosystem-logic-proxy
        tag: "10.5.0-PRE-1"
        pullPolicy: Always


    port: 8004
    nodeEnvironment: production

    # -- db config
    db:
      host: mongodb-svc
      database: belp_db
      user: belp
      secretKey: password
    basePath: /opt/business-ecosystem-logic-proxy

    externalIdp:
      enabled: true
    initContainers: false
    propagateToken: true

dsp:
  ## configuration for the k8s service to access cp
  service:
    # -- service type
    type: ClusterIP
    # -- port to be used by the service
    port: 8081
    # -- additional annotations, if required
    annotations: { }
    # -- define the name of the service and avoid generating one
    serviceNameOverride: ""
    protocol:
      port: 8080
    control:
      port: 8082
    catalog:
      port: 8083
    version:
      port: 8084
    management:
      port: 8085

  ## deployment specific configuration
  deployment:
    # -- port that the cp container uses
    port: 8080
    # -- base path of the controlplane
    path: /api
    # -- initial number of target replications, can be different if autoscaling is enabled
    replicaCount: 1
    # -- number of old replicas to be retained
    revisionHistoryLimit: 3
    ## configuration of the cp update strategy
    updateStrategy:
      # -- type of the update
      type: RollingUpdate
      # -- new pods will be added gradually
      rollingUpdate:
        # -- number of pods that can be created above the desired amount while updating
        maxSurge: 1
        # -- number of pods that can be unavailable while updating
        maxUnavailable: 0
    ## configuration of the image to be used
    image:
      # -- cp image name
      repository: quay.io/wi_stefan/fdsc-edc-controlplane-dcp
      # -- tag of the image to be used
      tag: 0.0.1-SNAPSHOT
      # -- specification of the image pull policy
      pullPolicy: Always
    # -- secrets for pulling images from a private repository
    # ref: https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/
    imagePullSecrets: [ ]
    # -- additional labels for the deployment, if required
    additionalLabels: { }
    # -- additional annotations for the deployment, if required
    additionalAnnotations: { }
    
    # -- additional volume
    additionalVolumeMounts:
      - name: credential-repo
        mountPath: /credential-repo
      - name: signing-key
        mountPath: /signing-key
      # add the self generated root ca to the system truststore
      - name: root-ca
        mountPath: /etc/ssl/cacert.pem
        subPath: cacert.pem
      - name: cacerts
        mountPath: /usr/lib/jvm/java-21/lib/security/cacerts
        subPath: cacerts
    # -- additional volumes to be added for the containers
    additionalVolumes:
      - name: marketplace-credential-script
        configMap:
          name: marketplace-credential
          defaultMode: 0755
      - name: ca-certs-script
        configMap:
          name: ca-certs-script
          defaultMode: 0755
      - name: credential-repo
        emptyDir: {}
      - name: signing-key
        secret:
          secretName: signing-key
      - name: root-ca
        secret:
          secretName: root-ca
      - name: cacerts
        emptyDir: {}
    ## cp resource requests and limits, we leave the default empty to make that a concious choice by the user.
    ## for the autoscaling to make sense, you should configure this.
    # resources:
    # limits:
    # cpu: 100m
    # memory: 128Mi
    # requests:
    # cpu: 100m
    # memory: 128Mi
    # -- selector template
    # ref: https://kubernetes.io/docs/user-guide/node-selection/
    nodeSelector: { }
    # -- tolerations template
    # ref: ref: https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/
    tolerations: [ ]
    # -- affinity template
    # ref: https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#affinity-and-anti-affinity
    affinity: { }
    ## liveness and readiness probes
    # ref: https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#container-probes
    livenessProbe:
      initialDelaySeconds: 30
      periodSeconds: 10
      successThreshold: 1
      timeoutSeconds: 30
    readinessProbe:
      initialDelaySeconds: 31
      periodSeconds: 10
      successThreshold: 1
      timeoutSeconds: 30
    # -- arguments to be set for the container
    args: [ ]
    # -- command to be used for starting the container
    command: [ ]
    # -- individual ports and paths


  ## pod autoscaling configuration, use for automatic scaling of the broker pods
  autoscaling:
    #  -- should autoscaling be enabled for cp
    enabled: false

  # -- a list of additional env vars to be set
  additonalEnvVars: [ ]

  config:
    oauth:
      tokenUrl:
    # -- configuration for the OID4VP extension
    oid4vp:
      # -- should the extension be enabled
      enabled: false
      # -- client id to be used for OID4VP
      clientId: "dsp"
      # -- scope to be used
      scope: "openid"
      # -- trust all certificates presented at https. DO NOT USE IN PRODUCTION
      trustAll: true
      # -- identification of the credentials holder
      holder:
        # -- id of the holder
        id:
        # -- kid to be used for signing, often the same as id
        kid:
        # -- algorithm to be used for signing the verifiable presentations
        signatureAlgorithm: ECDH-ES
        # -- key to be used for signing the presentations
        key:  
          # -- type of the key
          type: EC
          # -- path to the key
          path: oid4vp/private-key.pem
      # -- folder of the credentials to be used for authentication 
      credentialsFolder: oid4vp/credentials
      # -- additional trust-anchors to be used for client identification(e.g. the verifier)
      trustAnchorsFolder:
      # -- claim used inside the jwts for identifying the organization
      organizationClaim: verifiableCredential.issuer
      # -- configuration of the proxy to be used for OID4VP authentication        
      proxy:
        # -- should a proxy be used at all
        enabled: false
        # -- host of the proxy
        host:
        # port of the proxy
        port:
    # -- configuration of the test-extension. Only relevant for running conformance tests
    testExtension:
      # -- should it be enabled
      enabled: false
      # -- configuration of the test controller
      controller:
        # -- should the controller providing additional test endpoints be enabled
        enabled: false
        # -- port that the test endpoints are available at
        port: 8687
        # -- path that the test endpoints are available at
        path: /tck
      # -- configuration of the test identity service
      identity:
        enabled: false
    
    # -- configuration of the TMForum extension
    tmfExtension:
      # -- should the extension be enabled
      enabled: true
      # -- address of the quote api to be used
      quoteApi:
      # -- address of the agreement api to be used
      agreementApi:
      # -- address of the product ordering api to be used
      productOrderApi:
      # -- address of the product catalog api to be used
      productCatalogApi:
      # -- address of the product inventory api to be used
      productInventoryApi:
      # -- address of the usage management api to be used
      usageManagementApi:
      # -- address of the party catalog api to be used
      partyCatalogApi:
      # -- should the tmforum extension for the catalog endpoint be enable
      catalog:
        enabled: true

    # -- configuration of the transfer process extension
    fdscTransfer:
      # -- should it be enabled
      enabled: true
      # -- host to be used for offering the transfer processes
      transferHost: 
      # -- configuration to be used in case provisioning of DCP secured resources is supported
      dcp:
        # -- should it be enabled
        enabled: false
        # -- address of the dsp-jwks endpoint
        oid:
          host:
          jwksPath: /.well-known/jwks
          openIdPath: /.well-known/openid-configuration

      # -- configuration to be used in case provisioning of OID4VC secured resources is supported
      oid4vc:
        # -- should OID4VC provisioning be enabled
        enabled: false
        # -- address of the credentials config service to be used
        credentialsConfigAddress: 
        # -- external host of the verifier to be used for OID4VP on transfers
        verifierHost:
        # -- internal host of the verifier to be used for OID4VP on transfers, the external one can also be reused here
        verifierInternalHost:
        # -- internal address of the open policy agent - to be used as PDP on the incoming routes 
        opaHost: http://localhost:8181
        # -- host of the ODRL-PAP to register the policies
        odrlPapHost: http://odrl-pap:8080
      # -- configuration of the apisix to be confiugured for serving the process
      apisix:
        # -- address of the management api of apisix
        address:
        # -- token to be used as an API-Key at the mangement api
        token:
        # -- in case the route should use a proxy, configure it here
        httpsProxy:
    
    ## -- configuration of the trusted issuers list to be use in case of DCP
    ebsiTir:
      ## -- should an ebsi-api based tir be used?
      enabled: false
      ## -- address to the trusted issuers list
      tilAddress: 

    ## -- configuration for dcp based authn/z
    dcp:
      ## -- should it be enabled
      enabled: false
      ## -- configuration of the default scopes for the endpoints
      scopes:
        ## -- scope for the catalog
        catalog:
        ## -- scope for interacting with the negotiation protocol
        negotiation:
        ## -- scope for interacting with the transfer protocol
        transfer:
        ## -- scope for the version endpoint
        version:

    ## -- general configuration for the edc
    edc:
      participant:
        ## -- id of the participant to be used
        id:
      log:
        ## -- loglevel to be used
        level: DEBUG
      # -- handling of edc internal json-ld resolution 
      jsonld:
        https: 
          enabled: true
        http: 
          enabled: trusted
    ## -- endpoints to be provided by the edc
    web:
      http:
        port: 8081
        ## -- configuration of the dsp protocol
        protocol:
          path: /api/dsp
          port: 8080
        ## -- configuration of the control api
        control:
          path: /api/control
          port: 8082
        ## -- configuration of the catalog api
        catalog:
          path: /api/catalog
          port: 8083
        ## -- configuration of the version api
        version:
          path: /api/version
          port: 8084
        ## -- configuration of the management api
        management:
          path: /api/v1/management
          port: 8085

# -- helper script to retrieve credentials for applications
credentials:
  # -- should the script be enabled
  enabled: false
  # -- config of the keycloak to get credentials from
  keycloak:
    # -- address of the keycloak
    address:
    # -- realm to be used
    realm: 
    # -- clientId to be used for retrieval
    clientId:
    # -- username to get the credentials for
    username:
    # -- scope to be used for the client
    scope:
    # -- password to authenticate with at keycloak
    password:
  # -- configurations of the credentials to be retrieved
  configurations: []
    # -- id of the credentials config to be used
    # - id: 
    # -- format to request the credential in
      # format:
    # -- name of the file to store the credential at
      # targetFile:
  
identityhub:
  enabled: false
  image:
    repository: "tractusx/identityhub"
    # -- Overrides the image tag whose default is the chart appVersion
    tag: sha-687d69f
    # -- [Kubernetes image pull policy](https://kubernetes.io/docs/concepts/containers/images/#image-pull-policy) to use
    pullPolicy: IfNotPresent
  initContainers: []
  useSVE: false
  debug:
    enabled: true
    port: 5005
    suspendOnStart: false
  livenessProbe:
    # -- Whether to enable kubernetes [liveness-probe](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/)
    enabled: true
    # -- seconds to wait before performing the first liveness check
    initialDelaySeconds: 5
    # -- this fields specifies that kubernetes should perform a liveness check every 5 seconds
    periodSeconds: 5
    # -- number of seconds after which the probe times out
    timeoutSeconds: 5
    # -- when a probe fails kubernetes will try 6 times before giving up
    failureThreshold: 6
    # -- number of consecutive successes for the probe to be considered successful after having failed
    successThreshold: 1
  readinessProbe:
    # -- Whether to enable kubernetes [readiness-probes](https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/)
    enabled: true
    # -- seconds to wait before performing the first readiness check
    initialDelaySeconds: 5
    # -- this fields specifies that kubernetes should perform a readiness check every 5 seconds
    periodSeconds: 5
    # -- number of seconds after which the probe times out
    timeoutSeconds: 5
    # -- when a probe fails kubernetes will try 6 times before giving up
    failureThreshold: 6
    # -- number of consecutive successes for the probe to be considered successful after having failed
    successThreshold: 1
  didIngress:
    enabled: true
    service: identityhub-service
    port: did
  # -- endpoints of the control plane
  endpoints:
    # -- default api for health checks, should not be added to any ingress
    default:
      # -- port for incoming api calls
      port: 8081
      # -- path for incoming api calls
      path: /api
    # -- management api, used by internal users, can be added to an ingress and must not be internet facing
    identity:
      # -- port for incoming api calls
      port: 8082
      # -- path for incoming api calls
      path: /api/identity
      # -- authentication key, must be attached to each 'X-Api-Key' request header
      authKeyAlias: "sup3r$3cr3t"
    # -- DCP Presentation API endpoint
    credentials:
      # -- port for incoming api calls
      port: 8083
      # -- path for incoming api calls
      path: /api/credentials
    # -- DID service endpoint. DID documents can be resolved from here.
    did:
      # -- port for incoming api calls
      port: 8084
      # -- path for incoming api calls
      path: /
    # -- STS Accounts API, used to manipulate STS accounts
    accounts:
      port: 8085
      path: /api/accounts
      authKeyAlias: "sup3r$3cr3t"
    # -- Version API, used to obtain exact version information about all APIs at runtime
    version:
      port: 8086
      path: /.well-known/api
    # -- STS Endpoint, used to obtain tokens
    sts:
      port: 8087
      path: /api/sts


  service:
    # -- [Service type](https://kubernetes.io/docs/concepts/services-networking/service/#publishing-services-service-types) to expose the running application on a set of Pods as a network service.
    type: ClusterIP
    annotations: {}
  # -- additional labels for the pod
  podLabels: {}
  # -- additional annotations for the pod
  podAnnotations: {}
  # -- The [pod security context](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-the-security-context-for-a-pod) defines privilege and access control settings for a Pod within the deployment
  podSecurityContext:
    seccompProfile:
      # -- Restrict a Container's Syscalls with seccomp
      type: RuntimeDefault
    # -- Runs all processes within a pod with a special uid
    runAsUser: 10100
    # -- Processes within a pod will belong to this guid
    runAsGroup: 10100
    # -- The owner for volumes and any files created within volumes will belong to this guid
    fsGroup: 10100
  # The [container security context](https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-the-security-context-for-a-container) defines privilege and access control settings for a Container within a pod
  securityContext:
    capabilities:
      # -- Specifies which capabilities to drop to reduce syscall attack surface
      drop:
        - ALL
      # -- Specifies which capabilities to add to issue specialized syscalls
      add: []
    # -- Whether the root filesystem is mounted in read-only mode
    readOnlyRootFilesystem: true
    # -- Controls [Privilege Escalation](https://kubernetes.io/docs/concepts/security/pod-security-policy/#privilege-escalation) enabling setuid binaries changing the effective user ID
    allowPrivilegeEscalation: false
    # -- Requires the container to run without root privileges
    runAsNonRoot: true
    # -- The container's process will run with the specified uid
    runAsUser: 10100
  # Extra environment variables that will be pass onto deployment pods
  env: {}
  #  ENV_NAME: value

  # "valueFrom" environment variable references that will be added to deployment pods. Name is templated.
  # ref: https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.19/#envvarsource-v1-core
  envValueFrom: {}
  #  ENV_NAME:c
  #    configMapKeyRef:
  #      name: configmap-name
  #      key: value_key
  #    secretKeyRef:
  #      name: secret-name
  #      key: value_key

  # [Kubernetes Secret Resource](https://kubernetes.io/docs/concepts/configuration/secret/) names to load environment variables from
  envSecretNames: []
  #  - first-secret
  #  - second-secret

  # [Kubernetes ConfigMap Resource](https://kubernetes.io/docs/concepts/configuration/configmap/) names to load environment variables from
  envConfigMapNames: ["identityhub-config", "identityhub-datasource-config"]
  #  - first-config-map
  #  - second-config-map


  # -- declare where to mount [volumes](https://kubernetes.io/docs/concepts/storage/volumes/) into the container
  volumeMounts: []
  # -- [volume](https://kubernetes.io/docs/concepts/storage/volumes/) directories
  volumes: []
  # -- [resource management](https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/) for the container
  resources:
    limits:
      cpu: 1.5
      memory: 512Mi
    requests:
      cpu: 500m
      memory: 128Mi
  replicaCount: 1
  autoscaling:
    # -- Enables [horizontal pod autoscaling](https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/)
    enabled: false
    # -- Minimal replicas if resource consumption falls below resource threshholds
    minReplicas: 1
    # -- Maximum replicas if resource consumption exceeds resource threshholds
    maxReplicas: 100
    # -- targetAverageUtilization of cpu provided to a pod
    targetCPUUtilizationPercentage: 80
    # -- targetAverageUtilization of memory provided to a pod
    targetMemoryUtilizationPercentage: 80
  # Configuration of the [Java Util Logging Facade](https://docs.oracle.com/javase/7/docs/technotes/guides/logging/overview.html)
  logging:
    # -- Enable logging to create .log files
    enabled: true
    persistence:
      # -- Enable .log files to persist in local machine
      enabled: false
    # -- List of handlers to use in the logger
    handlers:
      - java.util.logging.ConsoleHandler
      - java.util.logging.FileHandler
    handlersConfig:
      # -- Console handler configuration
      java.util.logging.ConsoleHandler:
        level: FINE
        formatter: org.eclipse.tractusx.identityhub.monitor.ColorfulFormatter
      java.util.logging.FileHandler:
        # -- Log level of handler
        level: FINE
        # -- Formatter to use in handler, formatter must be set in identityhub.logging.formatters
        formatter: org.eclipse.tractusx.identityhub.monitor.ColorfulFormatter
        # -- Path where the log is created, must be the same path as the logging.path values
        pattern: /app/logs/identityhub.log
        # -- Limit of bytes to write before log file rotation
        limit: 0
        # -- Number of files to use in log file rotation
        count: 1
        # -- Append logs to the file or create new file every deployment
        append: true
    formatters:
      # -- configuration of custom colorful formatter
      org.eclipse.tractusx.identityhub.monitor.ColorfulFormatter:
        format: "%7$s[%1$tY-%1$tm-%1$td %1$tH:%1$tM:%1$tS] [%4$s] %5$s%6$s%n%8$s"
    # -- root log level
    level: INFO
    # -- package level control
    # @default -- `{"org.eclipse.edc": "FINE"}`
    logLevels:
      org.glassfish: "OFF"
      jdk.event: "OFF"
      jakarta.json: "OFF"
      org.jvnet: "OFF"
      okhttp3.internal: "OFF"
      org.flywaydb: "OFF"
      org.postgresql: "OFF"
      org.eclipse.edc: "FINE"
      org.eclipse.tractusx: "FINE"
    # -- path where the log resides, must be the same path as the fileHandler pattern
    path: /app/logs
    # -- default logging properties if logging is not enabled
    default: |-
      .level=INFO
      org.eclipse.edc.level=INFO
      handlers=java.util.logging.ConsoleHandler
      java.util.logging.ConsoleHandler.formatter=org.eclipse.tractusx.identityhub.monitor.ColorfulFormatter
      java.util.logging.ConsoleHandler.level=ALL
      org.eclipse.tractusx.identityhub.monitor.ColorfulFormatter.format=%7$s[%1$tY-%1$tm-%1$td %1$tH:%1$tM:%1$tS] [%4$s] %5$s%6$s%n%8$s
  # [node selector](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector) to constrain pods to nodes
  nodeSelector: {}
  # [tolerations](https://kubernetes.io/docs/concepts/scheduling-eviction/taint-and-toleration/) to configure preferred nodes
  tolerations: []
  # [affinity](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#affinity-and-anti-affinity) to configure which nodes the pods can be scheduled on
  affinity: {}
  url:
    # -- Explicitly declared url for reaching the dsp api (e.g. if ingresses not used)
    protocol: ""
    public: ""
    readiness: ""
  postgresql:
    host:
    port:
    database: "ih"
    auth:
      username: "user"
      password: "password"
      existingSecret: database-secret
      existingSecretPasswordKey: postgres-admin-password

vault:
  enabled: false
  injector:
    enabled: false
  server:
    dev:
      enabled: true
      devRootToken: "root"
    postStart:    # must be set externally!
  hashicorp:
    url: "http://{{ .Release.Name }}-vault:8200"
    token: "root"
    timeout: 30
    healthCheck:
      enabled: true
      standbyOk: true
    paths:
      secret: /v1/secret
      health: /v1/sys/health